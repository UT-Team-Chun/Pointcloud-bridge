2025-01-08 22:19:09,861 - INFO - Training configuration:
2025-01-08 22:19:09,862 - INFO - transformer_config: {'trans_dim': 384, 'depth': 12, 'drop_path_rate': 0.1, 'num_heads': 6, 'encoder_dims': 384}
2025-01-08 22:19:09,862 - INFO - num_group: 64
2025-01-08 22:19:09,862 - INFO - group_size: 32
2025-01-08 22:19:09,862 - INFO - num_points: 4096
2025-01-08 22:19:09,862 - INFO - chunk_size: 4096
2025-01-08 22:19:09,862 - INFO - overlap: 1024
2025-01-08 22:19:09,862 - INFO - batch_size: 8
2025-01-08 22:19:09,863 - INFO - num_workers: 0
2025-01-08 22:19:09,863 - INFO - learning_rate: 0.001
2025-01-08 22:19:09,863 - INFO - num_classes: 5
2025-01-08 22:19:09,863 - INFO - num_epochs: 500
2025-01-08 22:19:09,863 - INFO - device: cuda
2025-01-08 22:19:09,863 - INFO - Using device: cuda
2025-01-08 22:19:09,864 - INFO - Loading dataset from cache: ../data/CB/all/train//cache\dataset_cache_points4096_size1.0_rate0.4_transformTrue_hash85cd6113.pt
2025-01-08 22:24:16,665 - INFO - Successfully loaded 23384 blocks from cache
2025-01-08 22:24:16,668 - INFO - Loading dataset from cache: ../data/CB/all/val//cache\dataset_cache_points4096_size1.0_rate0.4_transformFalse_hashc8b72f08.pt
2025-01-08 22:28:48,837 - INFO - Successfully loaded 6563 blocks from cache
2025-01-08 22:28:48,837 - INFO - reading val data
2025-01-08 22:28:48,838 - INFO - Train dataset size: 23384
2025-01-08 22:28:48,838 - INFO - Val dataset size: 6563
2025-01-08 22:29:01,033 - INFO - Class weights: tensor([0.3896, 2.3235, 0.9726, 1.4584, 3.4639])
2025-01-08 22:29:01,034 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-08 23:41:11,066 - INFO - Validation parameter calculation time: 0:00:00.013508
2025-01-08 23:41:11,066 - INFO - 
Epoch 1/500:
2025-01-08 23:41:11,066 - INFO - Train Loss: 0.6812, Train Acc: 73.40%
2025-01-08 23:41:11,066 - INFO - Val Loss: 0.4876, Val Acc: 86.70%
2025-01-08 23:41:11,067 - INFO - Class 0 Accuracy: 95.70%
2025-01-08 23:41:11,068 - INFO - Class 1 Accuracy: 88.82%
2025-01-08 23:41:11,068 - INFO - Class 2 Accuracy: 73.02%
2025-01-08 23:41:11,069 - INFO - Class 3 Accuracy: 75.08%
2025-01-08 23:41:11,069 - INFO - Class 4 Accuracy: 87.06%
2025-01-08 23:41:11,587 - INFO - Saved best model with accuracy: 86.70%
2025-01-08 23:41:12,020 - INFO - Saved checkpoint at epoch 1
2025-01-08 23:41:12,021 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 00:53:08,509 - INFO - Validation parameter calculation time: 0:00:00.013190
2025-01-09 00:53:08,509 - INFO - 
Epoch 2/500:
2025-01-09 00:53:08,509 - INFO - Train Loss: 0.3374, Train Acc: 87.38%
2025-01-09 00:53:08,509 - INFO - Val Loss: 1.5667, Val Acc: 72.82%
2025-01-09 00:53:08,510 - INFO - Class 0 Accuracy: 99.16%
2025-01-09 00:53:08,510 - INFO - Class 1 Accuracy: 0.14%
2025-01-09 00:53:08,510 - INFO - Class 2 Accuracy: 39.23%
2025-01-09 00:53:08,511 - INFO - Class 3 Accuracy: 62.32%
2025-01-09 00:53:08,511 - INFO - Class 4 Accuracy: 83.49%
2025-01-09 00:53:09,430 - INFO - Saved checkpoint at epoch 2
2025-01-09 00:53:09,432 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 02:05:24,510 - INFO - Validation parameter calculation time: 0:00:00.013066
2025-01-09 02:05:24,510 - INFO - 
Epoch 3/500:
2025-01-09 02:05:24,510 - INFO - Train Loss: 0.2804, Train Acc: 89.60%
2025-01-09 02:05:24,510 - INFO - Val Loss: 0.4384, Val Acc: 84.82%
2025-01-09 02:05:24,511 - INFO - Class 0 Accuracy: 93.11%
2025-01-09 02:05:24,512 - INFO - Class 1 Accuracy: 96.65%
2025-01-09 02:05:24,512 - INFO - Class 2 Accuracy: 63.18%
2025-01-09 02:05:24,513 - INFO - Class 3 Accuracy: 82.49%
2025-01-09 02:05:24,513 - INFO - Class 4 Accuracy: 94.87%
2025-01-09 02:05:25,316 - INFO - Saved checkpoint at epoch 3
2025-01-09 02:05:25,317 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 03:17:38,666 - INFO - Validation parameter calculation time: 0:00:00.013040
2025-01-09 03:17:38,667 - INFO - 
Epoch 4/500:
2025-01-09 03:17:38,667 - INFO - Train Loss: 0.2473, Train Acc: 90.84%
2025-01-09 03:17:38,667 - INFO - Val Loss: 30.0230, Val Acc: 52.53%
2025-01-09 03:17:38,667 - INFO - Class 0 Accuracy: 100.00%
2025-01-09 03:17:38,668 - INFO - Class 1 Accuracy: 0.00%
2025-01-09 03:17:38,669 - INFO - Class 2 Accuracy: 0.00%
2025-01-09 03:17:38,669 - INFO - Class 3 Accuracy: 0.00%
2025-01-09 03:17:38,670 - INFO - Class 4 Accuracy: 0.00%
2025-01-09 03:17:40,336 - INFO - Saved checkpoint at epoch 4
2025-01-09 03:17:40,337 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 04:29:51,531 - INFO - Validation parameter calculation time: 0:00:00.013018
2025-01-09 04:29:51,531 - INFO - 
Epoch 5/500:
2025-01-09 04:29:51,531 - INFO - Train Loss: 0.2335, Train Acc: 91.23%
2025-01-09 04:29:51,531 - INFO - Val Loss: 0.3386, Val Acc: 90.96%
2025-01-09 04:29:51,531 - INFO - Class 0 Accuracy: 97.33%
2025-01-09 04:29:51,532 - INFO - Class 1 Accuracy: 92.36%
2025-01-09 04:29:51,532 - INFO - Class 2 Accuracy: 79.11%
2025-01-09 04:29:51,533 - INFO - Class 3 Accuracy: 85.79%
2025-01-09 04:29:51,533 - INFO - Class 4 Accuracy: 94.01%
2025-01-09 04:29:52,084 - INFO - Saved best model with accuracy: 90.96%
2025-01-09 04:29:52,824 - INFO - Saved checkpoint at epoch 5
2025-01-09 04:29:52,826 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 05:42:03,171 - INFO - Validation parameter calculation time: 0:00:00.013537
2025-01-09 05:42:03,172 - INFO - 
Epoch 6/500:
2025-01-09 05:42:03,172 - INFO - Train Loss: 0.2117, Train Acc: 92.01%
2025-01-09 05:42:03,172 - INFO - Val Loss: 6.6103, Val Acc: 53.28%
2025-01-09 05:42:03,172 - INFO - Class 0 Accuracy: 100.00%
2025-01-09 05:42:03,173 - INFO - Class 1 Accuracy: 0.00%
2025-01-09 05:42:03,173 - INFO - Class 2 Accuracy: 0.37%
2025-01-09 05:42:03,174 - INFO - Class 3 Accuracy: 4.42%
2025-01-09 05:42:03,175 - INFO - Class 4 Accuracy: 1.02%
2025-01-09 05:42:03,819 - INFO - Saved checkpoint at epoch 6
2025-01-09 05:42:03,821 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 06:54:24,287 - INFO - Validation parameter calculation time: 0:00:00.013014
2025-01-09 06:54:24,287 - INFO - 
Epoch 7/500:
2025-01-09 06:54:24,287 - INFO - Train Loss: 0.2102, Train Acc: 92.17%
2025-01-09 06:54:24,287 - INFO - Val Loss: 9.4473, Val Acc: 52.67%
2025-01-09 06:54:24,288 - INFO - Class 0 Accuracy: 100.00%
2025-01-09 06:54:24,288 - INFO - Class 1 Accuracy: 0.17%
2025-01-09 06:54:24,289 - INFO - Class 2 Accuracy: 0.01%
2025-01-09 06:54:24,289 - INFO - Class 3 Accuracy: 0.90%
2025-01-09 06:54:24,289 - INFO - Class 4 Accuracy: 0.00%
2025-01-09 06:54:24,851 - INFO - Saved checkpoint at epoch 7
2025-01-09 06:54:24,852 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 08:06:30,057 - INFO - Validation parameter calculation time: 0:00:00.013098
2025-01-09 08:06:30,057 - INFO - 
Epoch 8/500:
2025-01-09 08:06:30,058 - INFO - Train Loss: 0.2013, Train Acc: 92.56%
2025-01-09 08:06:30,058 - INFO - Val Loss: 0.6879, Val Acc: 86.13%
2025-01-09 08:06:30,058 - INFO - Class 0 Accuracy: 98.96%
2025-01-09 08:06:30,058 - INFO - Class 1 Accuracy: 89.83%
2025-01-09 08:06:30,059 - INFO - Class 2 Accuracy: 86.67%
2025-01-09 08:06:30,059 - INFO - Class 3 Accuracy: 40.24%
2025-01-09 08:06:30,060 - INFO - Class 4 Accuracy: 67.90%
2025-01-09 08:06:30,498 - INFO - Saved checkpoint at epoch 8
2025-01-09 08:06:30,499 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 09:18:51,455 - INFO - Validation parameter calculation time: 0:00:00.012618
2025-01-09 09:18:51,456 - INFO - 
Epoch 9/500:
2025-01-09 09:18:51,456 - INFO - Train Loss: 0.1893, Train Acc: 92.92%
2025-01-09 09:18:51,456 - INFO - Val Loss: 63.0759, Val Acc: 52.53%
2025-01-09 09:18:51,456 - INFO - Class 0 Accuracy: 100.00%
2025-01-09 09:18:51,457 - INFO - Class 1 Accuracy: 0.00%
2025-01-09 09:18:51,457 - INFO - Class 2 Accuracy: 0.00%
2025-01-09 09:18:51,457 - INFO - Class 3 Accuracy: 0.00%
2025-01-09 09:18:51,458 - INFO - Class 4 Accuracy: 0.00%
2025-01-09 09:18:52,493 - INFO - Saved checkpoint at epoch 9
2025-01-09 09:18:52,494 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 10:30:47,787 - INFO - Validation parameter calculation time: 0:00:00.014021
2025-01-09 10:30:47,788 - INFO - 
Epoch 10/500:
2025-01-09 10:30:47,788 - INFO - Train Loss: 0.1832, Train Acc: 93.19%
2025-01-09 10:30:47,788 - INFO - Val Loss: 33.2656, Val Acc: 52.53%
2025-01-09 10:30:47,788 - INFO - Class 0 Accuracy: 100.00%
2025-01-09 10:30:47,789 - INFO - Class 1 Accuracy: 0.00%
2025-01-09 10:30:47,789 - INFO - Class 2 Accuracy: 0.00%
2025-01-09 10:30:47,790 - INFO - Class 3 Accuracy: 0.00%
2025-01-09 10:30:47,790 - INFO - Class 4 Accuracy: 0.00%
2025-01-09 10:30:48,375 - INFO - Saved checkpoint at epoch 10
2025-01-09 10:30:48,377 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 11:42:50,096 - INFO - Validation parameter calculation time: 0:00:00.013553
2025-01-09 11:42:50,097 - INFO - 
Epoch 11/500:
2025-01-09 11:42:50,097 - INFO - Train Loss: 0.1828, Train Acc: 93.26%
2025-01-09 11:42:50,097 - INFO - Val Loss: 0.2038, Val Acc: 92.87%
2025-01-09 11:42:50,097 - INFO - Class 0 Accuracy: 93.34%
2025-01-09 11:42:50,098 - INFO - Class 1 Accuracy: 95.03%
2025-01-09 11:42:50,098 - INFO - Class 2 Accuracy: 91.04%
2025-01-09 11:42:50,099 - INFO - Class 3 Accuracy: 93.97%
2025-01-09 11:42:50,099 - INFO - Class 4 Accuracy: 89.42%
2025-01-09 11:42:51,541 - INFO - Saved best model with accuracy: 92.87%
2025-01-09 11:42:52,413 - INFO - Saved checkpoint at epoch 11
2025-01-09 11:42:52,414 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 13:03:57,804 - INFO - Validation parameter calculation time: 0:00:00.014127
2025-01-09 13:03:57,804 - INFO - 
Epoch 12/500:
2025-01-09 13:03:57,804 - INFO - Train Loss: 0.1733, Train Acc: 93.63%
2025-01-09 13:03:57,804 - INFO - Val Loss: 0.2711, Val Acc: 90.43%
2025-01-09 13:03:57,805 - INFO - Class 0 Accuracy: 89.74%
2025-01-09 13:03:57,805 - INFO - Class 1 Accuracy: 97.88%
2025-01-09 13:03:57,806 - INFO - Class 2 Accuracy: 93.86%
2025-01-09 13:03:57,806 - INFO - Class 3 Accuracy: 84.60%
2025-01-09 13:03:57,806 - INFO - Class 4 Accuracy: 87.33%
2025-01-09 13:03:58,283 - INFO - Saved checkpoint at epoch 12
2025-01-09 13:03:58,285 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
2025-01-09 14:24:58,336 - INFO - Validation parameter calculation time: 0:00:00.014189
2025-01-09 14:24:58,337 - INFO - 
Epoch 13/500:
2025-01-09 14:24:58,337 - INFO - Train Loss: 0.1716, Train Acc: 93.67%
2025-01-09 14:24:58,337 - INFO - Val Loss: 0.2442, Val Acc: 89.55%
2025-01-09 14:24:58,338 - INFO - Class 0 Accuracy: 88.75%
2025-01-09 14:24:58,338 - INFO - Class 1 Accuracy: 97.44%
2025-01-09 14:24:58,339 - INFO - Class 2 Accuracy: 87.95%
2025-01-09 14:24:58,339 - INFO - Class 3 Accuracy: 90.24%
2025-01-09 14:24:58,340 - INFO - Class 4 Accuracy: 95.44%
2025-01-09 14:24:58,823 - INFO - Saved checkpoint at epoch 13
2025-01-09 14:24:58,825 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001AC95B54B50>
