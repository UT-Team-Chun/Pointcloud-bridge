2025-01-28 22:22:21,924 - INFO - Training configuration:
2025-01-28 22:22:21,926 - INFO - num_group: 64
2025-01-28 22:22:21,926 - INFO - group_size: 32
2025-01-28 22:22:21,926 - INFO - num_points: 4096
2025-01-28 22:22:21,926 - INFO - chunk_size: 4096
2025-01-28 22:22:21,926 - INFO - overlap: 1024
2025-01-28 22:22:21,926 - INFO - batch_size: 12
2025-01-28 22:22:21,926 - INFO - num_workers: 8
2025-01-28 22:22:21,926 - INFO - learning_rate: 0.001
2025-01-28 22:22:21,927 - INFO - num_classes: 5
2025-01-28 22:22:21,927 - INFO - num_epochs: 500
2025-01-28 22:22:21,927 - INFO - device: cuda
2025-01-28 22:22:21,927 - INFO - Using device: cuda
2025-01-28 22:22:21,927 - INFO - Loading cached data from ../data/CB/all/train/cache\dataset_21bc99fed81d.npz
2025-01-28 22:22:22,461 - INFO - Loading cached data from ../data/CB/all/val/cache\dataset_a2554e8c0fc4.npz
2025-01-28 22:22:22,464 - INFO - reading val data
2025-01-28 22:22:22,465 - INFO - Train dataset size: 4
2025-01-28 22:22:22,465 - INFO - Val dataset size: 2
2025-01-28 22:22:22,809 - INFO - Class weights: tensor([ 0.2667, 10.0000, 10.0000, 10.0000,  0.8000])
2025-01-28 22:22:22,811 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:23:15,378 - INFO - Validation parameter calculation time: 0:00:00.000535
2025-01-28 22:23:15,379 - INFO - 
Epoch 1/500:
2025-01-28 22:23:15,379 - INFO - Train Loss: 1.5683, Train Acc: 33.76%
2025-01-28 22:23:15,379 - INFO - Val Loss: 1.5857, Val Acc: 83.64%
2025-01-28 22:23:15,379 - INFO - Class 0 Accuracy: 83.64%
2025-01-28 22:23:15,380 - INFO - Class 1 Accuracy: 0.00%
2025-01-28 22:23:15,380 - INFO - Class 2 Accuracy: 0.00%
2025-01-28 22:23:15,381 - INFO - Class 3 Accuracy: 0.00%
2025-01-28 22:23:15,381 - INFO - Class 4 Accuracy: 0.00%
2025-01-28 22:23:15,472 - INFO - Saved best model with accuracy: 83.64%
2025-01-28 22:23:15,559 - INFO - Saved checkpoint at epoch 1
2025-01-28 22:23:15,560 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:24:07,210 - INFO - Validation parameter calculation time: 0:00:00.001011
2025-01-28 22:24:07,210 - INFO - 
Epoch 2/500:
2025-01-28 22:24:07,210 - INFO - Train Loss: 1.5376, Train Acc: 32.04%
2025-01-28 22:24:07,210 - INFO - Val Loss: 1.5761, Val Acc: 99.63%
2025-01-28 22:24:07,211 - INFO - Class 0 Accuracy: 99.63%
2025-01-28 22:24:07,212 - INFO - Class 1 Accuracy: 0.00%
2025-01-28 22:24:07,213 - INFO - Class 2 Accuracy: 0.00%
2025-01-28 22:24:07,213 - INFO - Class 3 Accuracy: 0.00%
2025-01-28 22:24:07,214 - INFO - Class 4 Accuracy: 0.00%
2025-01-28 22:24:07,309 - INFO - Saved best model with accuracy: 99.63%
2025-01-28 22:24:07,399 - INFO - Saved checkpoint at epoch 2
2025-01-28 22:24:07,401 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:24:59,868 - INFO - Validation parameter calculation time: 0:00:00.001509
2025-01-28 22:24:59,869 - INFO - 
Epoch 3/500:
2025-01-28 22:24:59,869 - INFO - Train Loss: 1.4028, Train Acc: 33.49%
2025-01-28 22:24:59,869 - INFO - Val Loss: 1.5671, Val Acc: 99.93%
2025-01-28 22:24:59,869 - INFO - Class 0 Accuracy: 99.93%
2025-01-28 22:24:59,870 - INFO - Class 1 Accuracy: 0.00%
2025-01-28 22:24:59,871 - INFO - Class 2 Accuracy: 0.00%
2025-01-28 22:24:59,871 - INFO - Class 3 Accuracy: 0.00%
2025-01-28 22:24:59,871 - INFO - Class 4 Accuracy: 0.00%
2025-01-28 22:24:59,966 - INFO - Saved best model with accuracy: 99.93%
2025-01-28 22:25:00,062 - INFO - Saved checkpoint at epoch 3
2025-01-28 22:25:00,063 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:25:52,291 - INFO - Validation parameter calculation time: 0:00:00.002086
2025-01-28 22:25:52,292 - INFO - 
Epoch 4/500:
2025-01-28 22:25:52,292 - INFO - Train Loss: 0.8984, Train Acc: 61.51%
2025-01-28 22:25:52,292 - INFO - Val Loss: 1.5560, Val Acc: 48.29%
2025-01-28 22:25:52,292 - INFO - Class 0 Accuracy: 48.29%
2025-01-28 22:25:52,293 - INFO - Class 1 Accuracy: 0.00%
2025-01-28 22:25:52,293 - INFO - Class 2 Accuracy: 0.00%
2025-01-28 22:25:52,294 - INFO - Class 3 Accuracy: 0.00%
2025-01-28 22:25:52,294 - INFO - Class 4 Accuracy: 0.00%
2025-01-28 22:25:52,398 - INFO - Saved checkpoint at epoch 4
2025-01-28 22:25:52,399 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:26:44,019 - INFO - Validation parameter calculation time: 0:00:00.001030
2025-01-28 22:26:44,020 - INFO - 
Epoch 5/500:
2025-01-28 22:26:44,020 - INFO - Train Loss: 1.2251, Train Acc: 47.89%
2025-01-28 22:26:44,020 - INFO - Val Loss: 1.5386, Val Acc: 38.02%
2025-01-28 22:26:44,021 - INFO - Class 0 Accuracy: 38.02%
2025-01-28 22:26:44,021 - INFO - Class 1 Accuracy: 0.00%
2025-01-28 22:26:44,022 - INFO - Class 2 Accuracy: 0.00%
2025-01-28 22:26:44,022 - INFO - Class 3 Accuracy: 0.00%
2025-01-28 22:26:44,023 - INFO - Class 4 Accuracy: 0.00%
2025-01-28 22:26:44,138 - INFO - Saved checkpoint at epoch 5
2025-01-28 22:26:44,140 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:27:36,396 - INFO - Validation parameter calculation time: 0:00:00.001090
2025-01-28 22:27:36,397 - INFO - 
Epoch 6/500:
2025-01-28 22:27:36,397 - INFO - Train Loss: 0.6841, Train Acc: 80.58%
2025-01-28 22:27:36,397 - INFO - Val Loss: 1.4853, Val Acc: 50.24%
2025-01-28 22:27:36,398 - INFO - Class 0 Accuracy: 50.24%
2025-01-28 22:27:36,399 - INFO - Class 1 Accuracy: 0.00%
2025-01-28 22:27:36,399 - INFO - Class 2 Accuracy: 0.00%
2025-01-28 22:27:36,399 - INFO - Class 3 Accuracy: 0.00%
2025-01-28 22:27:36,400 - INFO - Class 4 Accuracy: 0.00%
2025-01-28 22:27:36,495 - INFO - Saved checkpoint at epoch 6
2025-01-28 22:27:36,496 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:28:27,800 - INFO - Validation parameter calculation time: 0:00:00.001028
2025-01-28 22:28:27,800 - INFO - 
Epoch 7/500:
2025-01-28 22:28:27,800 - INFO - Train Loss: 0.6073, Train Acc: 80.39%
2025-01-28 22:28:27,800 - INFO - Val Loss: 1.3777, Val Acc: 50.44%
2025-01-28 22:28:27,801 - INFO - Class 0 Accuracy: 50.44%
2025-01-28 22:28:27,802 - INFO - Class 1 Accuracy: 0.00%
2025-01-28 22:28:27,802 - INFO - Class 2 Accuracy: 0.00%
2025-01-28 22:28:27,803 - INFO - Class 3 Accuracy: 0.00%
2025-01-28 22:28:27,803 - INFO - Class 4 Accuracy: 0.00%
2025-01-28 22:28:27,902 - INFO - Saved checkpoint at epoch 7
2025-01-28 22:28:27,903 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:29:18,738 - INFO - Validation parameter calculation time: 0:00:00.001504
2025-01-28 22:29:18,740 - INFO - 
Epoch 8/500:
2025-01-28 22:29:18,740 - INFO - Train Loss: 0.5053, Train Acc: 91.67%
2025-01-28 22:29:18,740 - INFO - Val Loss: 1.3957, Val Acc: 50.44%
2025-01-28 22:29:18,740 - INFO - Class 0 Accuracy: 50.44%
2025-01-28 22:29:18,741 - INFO - Class 1 Accuracy: 0.00%
2025-01-28 22:29:18,741 - INFO - Class 2 Accuracy: 0.00%
2025-01-28 22:29:18,741 - INFO - Class 3 Accuracy: 0.00%
2025-01-28 22:29:18,742 - INFO - Class 4 Accuracy: 0.00%
2025-01-28 22:29:18,838 - INFO - Saved checkpoint at epoch 8
2025-01-28 22:29:18,839 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:30:09,992 - INFO - Validation parameter calculation time: 0:00:00.001022
2025-01-28 22:30:09,993 - INFO - 
Epoch 9/500:
2025-01-28 22:30:09,993 - INFO - Train Loss: 0.6869, Train Acc: 73.57%
2025-01-28 22:30:09,993 - INFO - Val Loss: 1.1083, Val Acc: 50.54%
2025-01-28 22:30:09,993 - INFO - Class 0 Accuracy: 50.54%
2025-01-28 22:30:09,994 - INFO - Class 1 Accuracy: 0.00%
2025-01-28 22:30:09,995 - INFO - Class 2 Accuracy: 0.00%
2025-01-28 22:30:09,995 - INFO - Class 3 Accuracy: 0.00%
2025-01-28 22:30:09,995 - INFO - Class 4 Accuracy: 0.00%
2025-01-28 22:30:10,086 - INFO - Saved checkpoint at epoch 9
2025-01-28 22:30:10,088 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:31:01,569 - INFO - Validation parameter calculation time: 0:00:00.001729
2025-01-28 22:31:01,569 - INFO - 
Epoch 10/500:
2025-01-28 22:31:01,570 - INFO - Train Loss: 0.3995, Train Acc: 98.56%
2025-01-28 22:31:01,570 - INFO - Val Loss: 0.9252, Val Acc: 50.39%
2025-01-28 22:31:01,570 - INFO - Class 0 Accuracy: 50.39%
2025-01-28 22:31:01,571 - INFO - Class 1 Accuracy: 0.00%
2025-01-28 22:31:01,571 - INFO - Class 2 Accuracy: 0.00%
2025-01-28 22:31:01,571 - INFO - Class 3 Accuracy: 0.00%
2025-01-28 22:31:01,572 - INFO - Class 4 Accuracy: 0.00%
2025-01-28 22:31:01,662 - INFO - Saved checkpoint at epoch 10
2025-01-28 22:31:01,663 - INFO - Total samples is: <torch.utils.data.dataloader.DataLoader object at 0x000001E92D187490>
2025-01-28 22:37:53,839 - INFO - Training configuration:
2025-01-28 22:37:53,840 - INFO - num_group: 64
2025-01-28 22:37:53,840 - INFO - group_size: 32
2025-01-28 22:37:53,840 - INFO - num_points: 4096
2025-01-28 22:37:53,840 - INFO - chunk_size: 4096
2025-01-28 22:37:53,840 - INFO - overlap: 1024
2025-01-28 22:37:53,840 - INFO - batch_size: 12
2025-01-28 22:37:53,840 - INFO - num_workers: 8
2025-01-28 22:37:53,840 - INFO - learning_rate: 0.001
2025-01-28 22:37:53,840 - INFO - num_classes: 5
2025-01-28 22:37:53,841 - INFO - num_epochs: 500
2025-01-28 22:37:53,841 - INFO - device: cuda
2025-01-28 22:37:53,841 - INFO - Using device: cuda
2025-01-28 22:37:53,841 - INFO - Loading cached data from ../data/CB/all/train/cache\dataset_21bc99fed81d.npz
2025-01-28 22:37:53,846 - INFO - Loading cached data from ../data/CB/all/val/cache\dataset_a2554e8c0fc4.npz
2025-01-28 22:37:53,847 - INFO - reading val data
2025-01-28 22:37:53,848 - ERROR - Training failed with exception:
Traceback (most recent call last):
  File "D:\Work\Pointcloud-WL\Pointcloud-bridge\Highway_bridge\train_MulSca_BriStruNet_CB.py", line 384, in <module>
    train()
  File "D:\Work\Pointcloud-WL\Pointcloud-bridge\Highway_bridge\train_MulSca_BriStruNet_CB.py", line 83, in train
    train_loader = DataLoader(
                   ^^^^^^^^^^^
  File "C:\Users\cy519\anaconda3\envs\pcdmulti\Lib\site-packages\torch\utils\data\dataloader.py", line 349, in __init__
    sampler = RandomSampler(dataset, generator=generator)  # type: ignore[arg-type]
              ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cy519\anaconda3\envs\pcdmulti\Lib\site-packages\torch\utils\data\sampler.py", line 140, in __init__
    raise ValueError(f"num_samples should be a positive integer value, but got num_samples={self.num_samples}")
ValueError: num_samples should be a positive integer value, but got num_samples=0
2025-01-28 22:45:30,433 - INFO - Training configuration:
2025-01-28 22:45:30,433 - INFO - num_group: 64
2025-01-28 22:45:30,434 - INFO - group_size: 32
2025-01-28 22:45:30,434 - INFO - num_points: 4096
2025-01-28 22:45:30,434 - INFO - chunk_size: 4096
2025-01-28 22:45:30,434 - INFO - overlap: 1024
2025-01-28 22:45:30,434 - INFO - batch_size: 12
2025-01-28 22:45:30,434 - INFO - num_workers: 8
2025-01-28 22:45:30,434 - INFO - learning_rate: 0.001
2025-01-28 22:45:30,434 - INFO - num_classes: 5
2025-01-28 22:45:30,434 - INFO - num_epochs: 500
2025-01-28 22:45:30,434 - INFO - device: cuda
2025-01-28 22:45:30,434 - INFO - Using device: cuda
2025-01-28 22:45:30,435 - INFO - Processing raw data...
2025-01-28 23:04:48,832 - INFO - Processing raw data...
2025-01-28 23:12:12,495 - INFO - reading val data
2025-01-28 23:12:12,496 - INFO - Train dataset size: 30132
2025-01-28 23:12:12,496 - INFO - Val dataset size: 9838
2025-01-28 23:12:12,625 - ERROR - Training failed with exception:
Traceback (most recent call last):
  File "D:\Work\Pointcloud-WL\Pointcloud-bridge\Highway_bridge\train_MulSca_BriStruNet_CB.py", line 384, in <module>
    train()
  File "D:\Work\Pointcloud-WL\Pointcloud-bridge\Highway_bridge\train_MulSca_BriStruNet_CB.py", line 112, in train
    shutil.copytree(source_path, destination_path)
  File "C:\Users\cy519\anaconda3\envs\pcdmulti\Lib\shutil.py", line 573, in copytree
    return _copytree(entries=entries, src=src, dst=dst, symlinks=symlinks,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "C:\Users\cy519\anaconda3\envs\pcdmulti\Lib\shutil.py", line 471, in _copytree
    os.makedirs(dst, exist_ok=dirs_exist_ok)
  File "<frozen os>", line 225, in makedirs
FileExistsError: [WinError 183] 既に存在するファイルを作成することはできません。: 'experiments\\exp_012822_brimulti_brienc_CB_all_weightedloss_bsize1\\models'
